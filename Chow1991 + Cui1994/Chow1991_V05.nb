(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12460,        303]
NotebookOptionsPosition[     11351,        276]
NotebookOutlinePosition[     11873,        295]
CellTagsIndexPosition[     11830,        292]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "k", ",", "d", ",", "z", ",", "h", ",", "epsp", ",", "epsr", ",", " ", 
   "epsp"}], "]"}]], "Input",
 CellChangeTimes->{{3.8384305790487347`*^9, 3.838430667431976*^9}, {
   3.8384307118873377`*^9, 3.8384307253034897`*^9}, {3.8384307988528028`*^9, 
   3.8384309139098215`*^9}, {3.838430949932067*^9, 3.838431025112438*^9}, {
   3.8384312535373707`*^9, 3.8384312581802626`*^9}, {3.8384312891723614`*^9, 
   3.8384313186315947`*^9}, {3.8384314398544645`*^9, 3.8384314543791885`*^9}, 
   3.838434813366969*^9, {3.8384353974620695`*^9, 3.838435498844607*^9}, {
   3.8384540628182096`*^9, 3.838454070735733*^9}, 3.838454103132261*^9, 
   3.838528454387945*^9, {3.838775377800106*^9, 3.838775380574408*^9}, 
   3.838775675615568*^9, {3.8387804248281145`*^9, 3.8387804309341173`*^9}, 
   3.838786266872411*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"5b677e94-0590-47a6-a3dd-4cd146dde8b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "0.05"}], ";", "  ", 
  RowBox[{"epsp", " ", "=", " ", 
   RowBox[{"1", "+", 
    RowBox[{"32", "*", "I"}]}]}], ";", " ", 
  RowBox[{"epsr", " ", "=", " ", "2.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"phi2", "[", 
     RowBox[{"k_", ",", "d_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "k"}], "*", 
         RowBox[{"(", 
          RowBox[{"z", "-", "d"}], ")"}]}], "]"}], ")"}], " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "d"}], "+", "h"}], ")"}], " ", "k"}]], " ", 
          RowBox[{"(", 
           RowBox[{"epsp", "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"2", " ", "h", " ", "k"}]], " ", "epsp"}], "+", "epsr", 
            "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"2", " ", "h", " ", "k"}]], " ", "epsr"}]}], ")"}]}], 
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"2", " ", "h", " ", "k"}]]}], ")"}], " ", "epsp"}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"2", " ", "h", " ", "k"}]]}], ")"}], " ", "epsr"}]}], 
           ")"}], " ", "k", " ", "\[Pi]"}]]}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Exp", "[", 
        RowBox[{"k", "*", 
         RowBox[{"(", 
          RowBox[{"z", "-", "d"}], ")"}]}], "]"}], ")"}], "*", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "k"}], "*", 
           RowBox[{"(", 
            RowBox[{"d", "-", "h"}], ")"}]}], "]"}], ")"}], 
        RowBox[{"4", "*", "\[Pi]", "*", "k"}]], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F1", "[", " ", 
    RowBox[{"k_", " ", ",", " ", "d_"}], "]"}], " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"phi2", "[", 
      RowBox[{"k", ",", "d"}], "]"}], " ", ")"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{"2", "*", "epsp", "*", "k"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.838431989635451*^9, 3.8384320374487467`*^9}, 
   3.838434245362583*^9, {3.8384348586413765`*^9, 3.838434882773391*^9}, {
   3.83843498744973*^9, 3.8384349908617473`*^9}, {3.8384350344357486`*^9, 
   3.838435127051453*^9}, {3.838435193135466*^9, 3.8384352756994944`*^9}, 
   3.8384353209510593`*^9, {3.838435669266677*^9, 3.8384357574529905`*^9}, {
   3.8384477571857853`*^9, 3.838447868339772*^9}, {3.8384480628012514`*^9, 
   3.8384480977003345`*^9}, {3.838448267930451*^9, 3.8384482733596716`*^9}, {
   3.8384533054081836`*^9, 3.838453340997575*^9}, {3.838453403293071*^9, 
   3.8384534120297627`*^9}, {3.8384535033793125`*^9, 
   3.8384535036293354`*^9}, {3.8384536745563717`*^9, 
   3.8384536800023575`*^9}, {3.8384539293625755`*^9, 
   3.8384539375924015`*^9}, {3.8384540744614725`*^9, 
   3.8384541224772205`*^9}, {3.838528466064666*^9, 3.838528486211866*^9}, {
   3.8386392148072557`*^9, 3.8386392561134143`*^9}, {3.8387752890343504`*^9, 
   3.838775327944601*^9}, {3.838775432484764*^9, 3.838775451516857*^9}, {
   3.838775497485344*^9, 3.8387755086262474`*^9}, {3.8387755393971963`*^9, 
   3.8387755823099165`*^9}, 3.8387756950367227`*^9, 3.8387757391778316`*^9, 
   3.838775770522272*^9, {3.8387786765952015`*^9, 3.8387788357612257`*^9}, {
   3.8387802635021114`*^9, 3.838780407108101*^9}, {3.8387804437531133`*^9, 
   3.838780444659096*^9}, {3.8387805233680935`*^9, 3.838780528051111*^9}, {
   3.8387805920621114`*^9, 3.8387806217161293`*^9}, {3.838780702969267*^9, 
   3.838780704299263*^9}, {3.838781054707258*^9, 3.8387811478962603`*^9}, {
   3.838782603318632*^9, 3.838782606338623*^9}, {3.838782643861627*^9, 
   3.838782668424608*^9}, {3.838784572696569*^9, 3.838784606051567*^9}, {
   3.8387862534743977`*^9, 3.8387862582033978`*^9}, {3.838786415168193*^9, 
   3.8387864193152027`*^9}, {3.8387954975588164`*^9, 
   3.8387955212458153`*^9}, {3.8414127454205947`*^9, 3.841412761410616*^9}, {
   3.841412801144611*^9, 3.8414128018356314`*^9}, {3.8414128414136124`*^9, 
   3.841412858316599*^9}, {3.841459957008685*^9, 3.8414599597844877`*^9}, {
   3.841460265312274*^9, 3.841460276116748*^9}, {3.8414603945287523`*^9, 
   3.841460410953968*^9}, {3.8414605173941507`*^9, 3.841460537781027*^9}, {
   3.8414755162446804`*^9, 3.8414755177183156`*^9}, {3.8414756833754168`*^9, 
   3.8414756857704525`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"85db4c52-cf96-4173-810d-4914082f68fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F1s", "[", 
    RowBox[{"k_", ",", "d_"}], "]"}], " ", "=", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"F1", "[", 
      RowBox[{"k", ",", "d"}], "]"}], ",", "d"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.841460254095422*^9, 3.841460292359787*^9}, {
  3.8414603433687387`*^9, 3.841460382610217*^9}, {3.8414604148386097`*^9, 
  3.8414604383628745`*^9}, {3.84146054706369*^9, 3.8414605523062706`*^9}, {
  3.8414606944844384`*^9, 3.8414607062591486`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"03867133-ef3f-4ed9-bef2-108c5bfc6fae"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"5.092958178940652`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.15915494309189515`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
    "d", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"0.05`", " ", "k"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1.0888955310856214`*^-17", "-", 
        RowBox[{"0.9999999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.1665237209571259`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9807456947643322`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"0.1`", " ", "k"}]]}]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2.546479089470326`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07957747154594758`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"0.05`", " ", "k"}], "-", 
       RowBox[{"2.`", " ", "d", " ", "k"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.1665237209571259`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9807456947643322`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"0.1`", " ", "k"}]]}]}], ")"}]}], "k"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "0.9807456947643323`"}], "-", 
     RowBox[{"0.16652372095712592`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
   RowBox[{"1.`", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"0.1`", " ", "k"}]]}]}]]], "Output",
 CellChangeTimes->{3.841460664844179*^9, 3.8414756013612347`*^9, 
  3.841475695837881*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"75707a1b-676f-4a8e-9610-8a42c876455e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.8414755366309447`*^9},ExpressionUUID->"8a09ba90-ee55-48e3-a807-\
d4467a92d438"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"F1s", "[", 
      RowBox[{"k", ",", "0.1"}], "]"}], " ", "-", " ", 
     RowBox[{"F1s", "[", 
      RowBox[{"k", ",", " ", 
       RowBox[{"-", "0.1"}]}], "]"}]}], ",", " ", 
    RowBox[{"k", "\[Rule]", " ", "\[Infinity]"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8385282092420025`*^9, 3.838528238081546*^9}, {
   3.838775551014397*^9, 3.8387755539989724`*^9}, {3.8387788455112195`*^9, 
   3.8387788485952253`*^9}, 3.838778889583208*^9, 3.841460430378726*^9, {
   3.841460554312995*^9, 3.8414605567086186`*^9}, {3.8414606183155303`*^9, 
   3.84146064911478*^9}, {3.841475563971677*^9, 3.8414755874916444`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"d317d9c6-acc0-4ea0-81a6-937700f38072"],

Cell[BoxData[
 TagBox[
  RowBox[{
   TagBox[
    RowBox[{"(", 
     RowBox[{"0.03123475237772118`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.9995120760870788`", " ", "\[ImaginaryI]"}]}], ")"}],
    "DirectedInfinityCoefficient",
    Editable->True], " ", "\[Infinity]"}],
  DirectedInfinity,
  Editable->False]], "Output",
 CellChangeTimes->{
  3.838528242442559*^9, 3.8385282762013025`*^9, 3.83852850071015*^9, 
   3.83852855607266*^9, {3.838639268964566*^9, 3.8386392719088254`*^9}, 
   3.83877553049957*^9, 3.838775594780216*^9, 3.8387757823908987`*^9, {
   3.8387788634072084`*^9, 3.8387788905142183`*^9}, 3.8387806093561654`*^9, 
   3.8387846205145597`*^9, 3.838786286172398*^9, 3.8387864415541873`*^9, 
   3.8414127811365967`*^9, 3.8414128145616117`*^9, {3.841412850622629*^9, 
   3.8414128641126127`*^9}, 3.8414129178676167`*^9, 3.841460476849276*^9, 
   3.8414605666806846`*^9, 3.8414606805077777`*^9, 3.8414756047246885`*^9, 
   3.8414757009126434`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"f4dc2dd9-91d7-446b-8897-8f38c8bf02f2"]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b835fba0-78ae-40b6-ab09-2bef6e292309"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 933, 15, 32, "Input",ExpressionUUID->"5b677e94-0590-47a6-a3dd-4cd146dde8b6"],
Cell[1494, 37, 5165, 115, 160, "Input",ExpressionUUID->"85db4c52-cf96-4173-810d-4914082f68fd"],
Cell[CellGroupData[{
Cell[6684, 156, 626, 14, 55, "Input",ExpressionUUID->"03867133-ef3f-4ed9-bef2-108c5bfc6fae"],
Cell[7313, 172, 1999, 51, 74, "Output",ExpressionUUID->"75707a1b-676f-4a8e-9610-8a42c876455e"]
}, Open  ]],
Cell[9327, 226, 130, 3, 32, "Input",ExpressionUUID->"8a09ba90-ee55-48e3-a807-d4467a92d438"],
Cell[CellGroupData[{
Cell[9482, 233, 807, 17, 55, "Input",ExpressionUUID->"d317d9c6-acc0-4ea0-81a6-937700f38072"],
Cell[10292, 252, 1043, 21, 56, "Output",ExpressionUUID->"f4dc2dd9-91d7-446b-8897-8f38c8bf02f2"]
}, Open  ]]
}
]
*)

